<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 840 400">
  <defs>
    <linearGradient id="bg2" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0d1117"/>
      <stop offset="100%" style="stop-color:#161b22"/>
    </linearGradient>
    <marker id="arr" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#6e7681"/>
    </marker>
    <marker id="arr-blue" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#58a6ff"/>
    </marker>
  </defs>

  <rect width="840" height="400" rx="10" fill="url(#bg2)"/>
  <rect x="1" y="1" width="838" height="398" rx="9" fill="none" stroke="#30363d" stroke-width="1"/>

  <!-- title -->
  <text x="420" y="30" font-family="'SF Mono', monospace" font-size="14" fill="#58a6ff" text-anchor="middle" font-weight="600">SNRE Architecture</text>

  <!-- PORTS layer -->
  <rect x="20" y="50" width="800" height="60" rx="8" fill="#1f6feb" fill-opacity="0.06" stroke="#1f6feb" stroke-width="0.8" stroke-dasharray="4,3"/>
  <text x="35" y="70" font-family="'SF Mono', monospace" font-size="10" fill="#58a6ff" opacity="0.7">PORTS (inbound)</text>

  <rect x="40" y="78" width="100" height="24" rx="5" fill="#1f6feb" fill-opacity="0.15" stroke="#58a6ff" stroke-width="0.8"/>
  <text x="90" y="94" font-family="'SF Mono', monospace" font-size="10" fill="#58a6ff" text-anchor="middle">Click CLI</text>

  <rect x="160" y="78" width="100" height="24" rx="5" fill="#1f6feb" fill-opacity="0.15" stroke="#58a6ff" stroke-width="0.8"/>
  <text x="210" y="94" font-family="'SF Mono', monospace" font-size="10" fill="#58a6ff" text-anchor="middle">FastAPI</text>

  <rect x="280" y="78" width="100" height="24" rx="5" fill="#1f6feb" fill-opacity="0.15" stroke="#58a6ff" stroke-width="0.8"/>
  <text x="330" y="94" font-family="'SF Mono', monospace" font-size="10" fill="#58a6ff" text-anchor="middle">/metrics</text>

  <!-- arrow down from ports to core -->
  <line x1="210" y1="110" x2="210" y2="135" stroke="#6e7681" stroke-width="1.2" marker-end="url(#arr)"/>

  <!-- DI Container -->
  <rect x="600" y="55" width="200" height="50" rx="8" fill="#8957e5" fill-opacity="0.08" stroke="#8957e5" stroke-width="0.8" stroke-dasharray="4,3"/>
  <text x="700" y="74" font-family="'SF Mono', monospace" font-size="10" fill="#bc8cff" text-anchor="middle">DI Container</text>
  <text x="700" y="92" font-family="'SF Mono', monospace" font-size="9" fill="#6e7681" text-anchor="middle">explicit wiring, no globals</text>

  <!-- CORE layer -->
  <rect x="20" y="140" width="560" height="110" rx="8" fill="#238636" fill-opacity="0.06" stroke="#238636" stroke-width="0.8" stroke-dasharray="4,3"/>
  <text x="35" y="160" font-family="'SF Mono', monospace" font-size="10" fill="#3fb950" opacity="0.7">CORE (domain logic)</text>

  <rect x="40" y="170" width="120" height="32" rx="5" fill="#238636" fill-opacity="0.12" stroke="#3fb950" stroke-width="0.8"/>
  <text x="100" y="190" font-family="'SF Mono', monospace" font-size="10" fill="#3fb950" text-anchor="middle">Coordinator</text>

  <rect x="180" y="170" width="120" height="32" rx="5" fill="#238636" fill-opacity="0.12" stroke="#3fb950" stroke-width="0.8"/>
  <text x="240" y="190" font-family="'SF Mono', monospace" font-size="10" fill="#3fb950" text-anchor="middle">Consensus</text>

  <rect x="320" y="170" width="120" height="32" rx="5" fill="#238636" fill-opacity="0.12" stroke="#3fb950" stroke-width="0.8"/>
  <text x="380" y="190" font-family="'SF Mono', monospace" font-size="10" fill="#3fb950" text-anchor="middle">Tracker</text>

  <rect x="120" y="210" width="120" height="32" rx="5" fill="#238636" fill-opacity="0.12" stroke="#3fb950" stroke-width="0.8"/>
  <text x="180" y="230" font-family="'SF Mono', monospace" font-size="10" fill="#3fb950" text-anchor="middle">Recorder</text>

  <!-- arrows between core components -->
  <line x1="160" y1="186" x2="178" y2="186" stroke="#6e7681" stroke-width="1" marker-end="url(#arr)"/>
  <line x1="300" y1="186" x2="318" y2="186" stroke="#6e7681" stroke-width="1" marker-end="url(#arr)"/>
  <line x1="100" y1="202" x2="130" y2="212" stroke="#6e7681" stroke-width="1" marker-end="url(#arr)"/>

  <!-- AGENTS layer -->
  <rect x="600" y="140" width="220" height="110" rx="8" fill="#da3633" fill-opacity="0.06" stroke="#f85149" stroke-width="0.8" stroke-dasharray="4,3"/>
  <text x="615" y="160" font-family="'SF Mono', monospace" font-size="10" fill="#f85149" opacity="0.7">AGENTS (strategies)</text>

  <rect x="620" y="170" width="80" height="24" rx="5" fill="#da3633" fill-opacity="0.1" stroke="#f85149" stroke-width="0.8"/>
  <text x="660" y="186" font-family="'SF Mono', monospace" font-size="9" fill="#f85149" text-anchor="middle">security</text>

  <rect x="720" y="170" width="80" height="24" rx="5" fill="#da3633" fill-opacity="0.1" stroke="#f85149" stroke-width="0.8"/>
  <text x="760" y="186" font-family="'SF Mono', monospace" font-size="9" fill="#f85149" text-anchor="middle">patterns</text>

  <rect x="620" y="200" width="80" height="24" rx="5" fill="#da3633" fill-opacity="0.1" stroke="#f85149" stroke-width="0.8"/>
  <text x="660" y="216" font-family="'SF Mono', monospace" font-size="9" fill="#f85149" text-anchor="middle">loops</text>

  <rect x="720" y="200" width="80" height="24" rx="5" fill="#da3633" fill-opacity="0.1" stroke="#f85149" stroke-width="0.8"/>
  <text x="760" y="216" font-family="'SF Mono', monospace" font-size="9" fill="#f85149" text-anchor="middle">plugins</text>

  <!-- arrow from core to agents -->
  <line x1="580" y1="186" x2="618" y2="186" stroke="#6e7681" stroke-width="1.2" marker-end="url(#arr)"/>

  <!-- MODELS layer -->
  <rect x="20" y="270" width="340" height="60" rx="8" fill="#d29922" fill-opacity="0.06" stroke="#e3b341" stroke-width="0.8" stroke-dasharray="4,3"/>
  <text x="35" y="290" font-family="'SF Mono', monospace" font-size="10" fill="#e3b341" opacity="0.7">MODELS (pydantic, zero logic)</text>

  <rect x="40" y="298" width="68" height="22" rx="4" fill="#d29922" fill-opacity="0.1" stroke="#e3b341" stroke-width="0.6"/>
  <text x="74" y="313" font-family="'SF Mono', monospace" font-size="9" fill="#e3b341" text-anchor="middle">Config</text>

  <rect x="118" y="298" width="68" height="22" rx="4" fill="#d29922" fill-opacity="0.1" stroke="#e3b341" stroke-width="0.6"/>
  <text x="152" y="313" font-family="'SF Mono', monospace" font-size="9" fill="#e3b341" text-anchor="middle">Change</text>

  <rect x="196" y="298" width="68" height="22" rx="4" fill="#d29922" fill-opacity="0.1" stroke="#e3b341" stroke-width="0.6"/>
  <text x="230" y="313" font-family="'SF Mono', monospace" font-size="9" fill="#e3b341" text-anchor="middle">Session</text>

  <rect x="274" y="298" width="68" height="22" rx="4" fill="#d29922" fill-opacity="0.1" stroke="#e3b341" stroke-width="0.6"/>
  <text x="308" y="313" font-family="'SF Mono', monospace" font-size="9" fill="#e3b341" text-anchor="middle">Profile</text>

  <!-- ADAPTERS layer -->
  <rect x="400" y="270" width="420" height="60" rx="8" fill="#8957e5" fill-opacity="0.06" stroke="#8957e5" stroke-width="0.8" stroke-dasharray="4,3"/>
  <text x="415" y="290" font-family="'SF Mono', monospace" font-size="10" fill="#bc8cff" opacity="0.7">ADAPTERS (outbound)</text>

  <rect x="420" y="298" width="100" height="22" rx="4" fill="#8957e5" fill-opacity="0.1" stroke="#bc8cff" stroke-width="0.6"/>
  <text x="470" y="313" font-family="'SF Mono', monospace" font-size="9" fill="#bc8cff" text-anchor="middle">File Repo</text>

  <rect x="530" y="298" width="100" height="22" rx="4" fill="#8957e5" fill-opacity="0.1" stroke="#bc8cff" stroke-width="0.6"/>
  <text x="580" y="313" font-family="'SF Mono', monospace" font-size="9" fill="#bc8cff" text-anchor="middle">SQLite Repo</text>

  <rect x="640" y="298" width="80" height="22" rx="4" fill="#8957e5" fill-opacity="0.1" stroke="#bc8cff" stroke-width="0.6"/>
  <text x="680" y="313" font-family="'SF Mono', monospace" font-size="9" fill="#bc8cff" text-anchor="middle">Git Hook</text>

  <rect x="728" y="298" width="80" height="22" rx="4" fill="#8957e5" fill-opacity="0.1" stroke="#bc8cff" stroke-width="0.6"/>
  <text x="768" y="313" font-family="'SF Mono', monospace" font-size="9" fill="#bc8cff" text-anchor="middle">Parser</text>

  <!-- arrow from core to adapters -->
  <line x1="200" y1="242" x2="200" y2="268" stroke="#6e7681" stroke-width="1" marker-end="url(#arr)"/>
  <line x1="380" y1="202" x2="500" y2="268" stroke="#6e7681" stroke-width="1" marker-end="url(#arr)"/>

  <!-- PROTOCOL label -->
  <rect x="20" y="350" width="800" height="38" rx="8" fill="#161b22" stroke="#30363d" stroke-width="0.8"/>
  <text x="420" y="370" font-family="'SF Mono', monospace" font-size="11" fill="#8b949e" text-anchor="middle">RefactoringAgent Protocol  |  SessionRepository Protocol  |  pydantic-settings  |  structlog  |  prometheus</text>
  <text x="420" y="383" font-family="'SF Mono', monospace" font-size="9" fill="#6e7681" text-anchor="middle">structural typing -- no inheritance required -- swap implementations without touching domain logic</text>

</svg>
